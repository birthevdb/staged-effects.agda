<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Expression.State</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Expression.State.html" class="Module">Expression.State</a> <a id="25" class="Symbol">(</a><a id="26" href="Expression.State.html#26" class="Bound">St</a> <a id="29" class="Symbol">:</a> <a id="31" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="34" class="Symbol">)</a> <a id="36" class="Keyword">where</a>

<a id="43" class="Keyword">open</a> <a id="48" class="Keyword">import</a> <a id="55" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.Product.html" class="Module">Data.Product</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="179" class="Keyword">hiding</a> <a id="186" class="Symbol">(</a><a id="187" href="Data.Maybe.Base.html#2246" class="Function Operator">_&gt;&gt;=_</a><a id="192" class="Symbol">)</a>

<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Denote.Sig.html" class="Module">Denote.Sig</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Denote.StagedSig.html" class="Module">Denote.StagedSig</a>
<a id="247" class="Keyword">open</a> <a id="252" class="Keyword">import</a> <a id="259" href="Denote.Tree.html" class="Module">Denote.Tree</a>

<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Effects.State.html" class="Module">Effects.State</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Value.Core.html" class="Module">Value.Core</a>

<a id="323" class="Keyword">module</a> <a id="330" href="Expression.State.html#330" class="Module">_</a> <a id="332" class="Symbol">{</a><a id="333" href="Expression.State.html#333" class="Bound">V</a> <a id="335" class="Symbol">:</a> <a id="337" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="340" class="Symbol">}</a> <a id="342" class="Keyword">where</a> 

  <a id="352" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="362" class="Symbol">:</a> <a id="364" href="Denote.Sig.html#327" class="Record">Sig</a>
  <a id="370" href="Denote.Sig.html#374" class="Field">Sig.S</a> <a id="376" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="386" class="Symbol">=</a> <a id="388" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="395" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="401" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="411" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="417" class="Symbol">=</a> <a id="419" href="Data.Empty.html#526" class="Datatype">⊥</a>  <a id="422" class="Comment">-- get</a>
  <a id="431" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="437" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="447" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="453" class="Symbol">=</a> <a id="455" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>  <a id="458" class="Comment">-- put e</a>

  <a id="470" class="Keyword">postulate</a> <a id="480" href="Expression.State.html#480" class="Postulate">ERROR</a> <a id="486" class="Symbol">:</a> <a id="488" class="Symbol">∀</a> <a id="490" class="Symbol">{</a><a id="491" href="Expression.State.html#491" class="Bound">A</a> <a id="493" class="Symbol">:</a> <a id="495" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="499" href="Denote.Sig.html#307" class="Generalizable">ℓ</a><a id="500" class="Symbol">}</a> <a id="502" class="Symbol">→</a> <a id="504" href="Expression.State.html#491" class="Bound">A</a>

  <a id="509" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="517" class="Symbol">:</a>   <a id="521" class="Symbol">⦃</a> <a id="523" href="Effects.State.html#508" class="Function">StateSig</a> <a id="532" href="Expression.State.html#26" class="Bound">St</a> <a id="535" href="Denote.StagedSig.html#784" class="Record Operator">⊏</a> <a id="537" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="539" class="Symbol">⦄</a>
            <a id="553" class="Symbol">→</a> <a id="555" class="Symbol">⦃</a> <a id="557" href="Expression.State.html#26" class="Bound">St</a> <a id="560" href="Value.Core.html#118" class="Record Operator">⊂</a> <a id="562" href="Expression.State.html#333" class="Bound">V</a> <a id="564" class="Symbol">⦄</a>
              <a id="580" class="Comment">--------------------</a>
            <a id="613" class="Symbol">→</a> <a id="615" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="625" href="Denote.Tree.html#1380" class="Record Operator">⟨</a> <a id="627" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="629" href="Denote.Tree.html#1380" class="Record Operator">⟩⇒</a> <a id="632" href="Expression.State.html#333" class="Bound">V</a>

  <a id="637" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="644" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="652" class="Symbol">(</a><a id="653" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="659" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="661" class="Symbol">_)</a> <a id="664" class="Symbol">=</a> <a id="666" class="Keyword">do</a>
    <a id="673" href="Expression.State.html#673" class="Bound">n</a> <a id="675" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="677" href="Effects.State.html#1100" class="Function">get</a>
    <a id="685" href="Denote.Tree.html#1261" class="Function">return</a> <a id="692" class="Symbol">(</a><a id="693" href="Value.Core.html#159" class="Field">inject</a> <a id="700" href="Expression.State.html#673" class="Bound">n</a><a id="701" class="Symbol">)</a>
  <a id="705" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="712" class="Symbol">(</a><a id="713" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="721" class="Symbol">⦃</a> <a id="723" class="Symbol">_</a> <a id="725" class="Symbol">⦄</a> <a id="727" class="Symbol">⦃</a> <a id="729" href="Expression.State.html#729" class="Bound">w</a> <a id="731" class="Symbol">⦄)</a> <a id="734" class="Symbol">(</a><a id="735" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="741" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="743" href="Expression.State.html#743" class="Bound">p</a><a id="744" class="Symbol">)</a> <a id="746" class="Symbol">=</a> <a id="748" class="Keyword">do</a>
    <a id="755" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="760" href="Expression.State.html#760" class="Bound">n</a> <a id="762" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="764" href="Denote.Tree.html#585" class="Function">mapᵀ</a> <a id="769" class="Symbol">(</a><a id="770" href="Value.Core.html#187" class="Field">project</a> <a id="778" class="Symbol">⦃</a> <a id="780" href="Expression.State.html#729" class="Bound">w</a> <a id="782" class="Symbol">⦄)</a> <a id="785" class="Symbol">(</a><a id="786" href="Expression.State.html#743" class="Bound">p</a> <a id="788" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="790" class="Symbol">)</a>
      <a id="798" class="Keyword">where</a> <a id="804" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="812" class="Symbol">→</a> <a id="814" href="Expression.State.html#480" class="Postulate">ERROR</a>
    <a id="824" href="Effects.State.html#1295" class="Function">put</a> <a id="828" href="Expression.State.html#760" class="Bound">n</a>
    <a id="834" href="Denote.Tree.html#1261" class="Function">return</a> <a id="841" class="Symbol">(</a><a id="842" href="Value.Core.html#159" class="Field">inject</a> <a id="849" href="Expression.State.html#760" class="Bound">n</a><a id="850" class="Symbol">)</a>

  <a id="855" href="Expression.State.html#855" class="Function">getᴱ</a> <a id="860" class="Symbol">:</a> <a id="862" class="Symbol">⦃</a> <a id="864" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="874" href="Denote.Sig.html#1392" class="Function Operator">⊰</a> <a id="876" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="878" class="Symbol">⦄</a> <a id="880" class="Symbol">→</a> <a id="882" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="884" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="888" href="Expression.State.html#855" class="Function">getᴱ</a> <a id="893" class="Symbol">=</a> <a id="895" href="Denote.Sig.html#1464" class="Function">injectᶜ</a> <a id="903" class="Symbol">(</a><a id="904" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="910" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="912" class="Symbol">λ())</a>

  <a id="920" href="Expression.State.html#920" class="Function">putᴱ</a> <a id="925" class="Symbol">:</a> <a id="927" class="Symbol">⦃</a> <a id="929" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="939" href="Denote.Sig.html#1392" class="Function Operator">⊰</a> <a id="941" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="943" class="Symbol">⦄</a> <a id="945" class="Symbol">→</a> <a id="947" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="949" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="951" class="Symbol">→</a> <a id="953" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="955" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="959" href="Expression.State.html#920" class="Function">putᴱ</a> <a id="964" href="Expression.State.html#964" class="Bound">e</a> <a id="966" class="Symbol">=</a> <a id="968" href="Denote.Sig.html#1464" class="Function">injectᶜ</a> <a id="976" class="Symbol">(</a><a id="977" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="982" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="984" class="Symbol">(λ</a> <a id="987" href="Expression.State.html#987" class="Bound">_</a> <a id="989" class="Symbol">→</a> <a id="991" href="Expression.State.html#964" class="Bound">e</a><a id="992" class="Symbol">))</a>
</pre></body></html>