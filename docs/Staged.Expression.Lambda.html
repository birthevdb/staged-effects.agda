<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Staged.Expression.Lambda</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--type-in-type</a> <a id="28" class="Symbol">#-}</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Staged.Expression.Lambda.html" class="Module">Staged.Expression.Lambda</a> <a id="65" class="Keyword">where</a>

<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="181" class="Keyword">open</a> <a id="186" class="Keyword">import</a> <a id="193" href="Data.Product.html" class="Module">Data.Product</a>

<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Staged.Denote.html" class="Module">Staged.Denote</a>
<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Staged.Effects.Lambda.html" class="Module">Staged.Effects.Lambda</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Staged.Value.Core.html" class="Module">Staged.Value.Core</a>

<a id="298" class="Keyword">module</a> <a id="305" href="Staged.Expression.Lambda.html#305" class="Module">_</a> <a id="307" class="Keyword">where</a>

  <a id="316" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="324" class="Symbol">:</a> <a id="326" href="Container.html#118" class="Record">Con</a>
  <a id="332" href="Container.html#166" class="Field">Con.S</a> <a id="338" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="346" class="Symbol">=</a> <a id="348" class="Symbol">(</a><a id="349" href="Staged.Effects.Lambda.html#626" class="Function">Name</a> <a id="354" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="356" href="Staged.Effects.Lambda.html#626" class="Function">Name</a><a id="360" class="Symbol">)</a> <a id="362" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="364" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="366" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="368" href="Staged.Effects.Lambda.html#626" class="Function">Name</a>
  <a id="375" href="Container.html#184" class="Field">Con.P</a> <a id="381" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="389" class="Symbol">(</a><a id="390" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="395" class="Symbol">(</a><a id="396" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="401" href="Staged.Expression.Lambda.html#401" class="Bound">x</a> <a id="403" class="Symbol">))</a> <a id="406" class="Symbol">=</a> <a id="408" href="Data.Empty.html#526" class="Datatype">⊥</a>     <a id="414" class="Comment">-- var x</a>
  <a id="425" href="Container.html#184" class="Field">Con.P</a> <a id="431" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="439" class="Symbol">(</a><a id="440" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="445" class="Symbol">(</a><a id="446" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="451" href="Staged.Expression.Lambda.html#451" class="Bound">y</a> <a id="453" class="Symbol">))</a> <a id="456" class="Symbol">=</a> <a id="458" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>     <a id="464" class="Comment">-- abs x e</a>
  <a id="477" href="Container.html#184" class="Field">Con.P</a> <a id="483" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="491" class="Symbol">(</a><a id="492" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="497" class="Symbol">(</a><a id="498" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="503" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="505" class="Symbol">))</a> <a id="508" class="Symbol">=</a> <a id="510" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>  <a id="516" class="Comment">-- app e e</a>
  <a id="529" href="Container.html#184" class="Field">Con.P</a> <a id="535" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="543" class="Symbol">(</a><a id="544" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="549" class="Symbol">(</a><a id="550" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="555" href="Staged.Expression.Lambda.html#555" class="Bound">y</a> <a id="557" class="Symbol">))</a> <a id="560" class="Symbol">=</a> <a id="562" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>  <a id="568" class="Comment">-- letin x e e</a>

<a id="584" class="Keyword">module</a> <a id="591" href="Staged.Expression.Lambda.html#591" class="Module">_</a> <a id="593" class="Symbol">{</a><a id="594" href="Staged.Expression.Lambda.html#594" class="Bound">V</a> <a id="596" class="Symbol">:</a> <a id="598" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="601" class="Symbol">}</a> <a id="603" class="Keyword">where</a> 

  <a id="613" href="Staged.Expression.Lambda.html#613" class="Function">⟦lambda⟧</a> <a id="622" class="Symbol">:</a>   <a id="626" class="Symbol">⦃</a> <a id="628" href="Staged.Effects.Lambda.html#807" class="Function">LamOpSig</a> <a id="637" href="Staged.Expression.Lambda.html#594" class="Bound">V</a> <a id="639" href="Staged.Denote.StagedSig.html#790" class="Record Operator">⊏</a> <a id="641" href="Staged.Denote.StagedSig.html#1063" class="Generalizable">ζ</a> <a id="643" class="Symbol">⦄</a>
             <a id="658" class="Symbol">→</a> <a id="660" class="Symbol">⦃</a> <a id="662" href="Staged.Effects.Lambda.html#1535" class="Datatype">Closure</a> <a id="670" href="Staged.Expression.Lambda.html#594" class="Bound">V</a> <a id="672" href="Staged.Value.Core.html#125" class="Record Operator">⊂</a> <a id="674" href="Staged.Expression.Lambda.html#594" class="Bound">V</a> <a id="676" class="Symbol">⦄</a>
               <a id="693" class="Comment">------------------</a>
             <a id="725" class="Symbol">→</a> <a id="727" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="735" href="Staged.Denote.Tree.html#1422" class="Record Operator">⟨</a> <a id="737" href="Staged.Denote.StagedSig.html#1063" class="Generalizable">ζ</a> <a id="739" href="Staged.Denote.Tree.html#1422" class="Record Operator">⟩⇒</a> <a id="742" href="Staged.Expression.Lambda.html#594" class="Bound">V</a>
  
  <a id="749" href="Staged.Denote.Tree.html#1488" class="Field">denote</a> <a id="756" href="Staged.Expression.Lambda.html#613" class="Function">⟦lambda⟧</a> <a id="765" class="Symbol">(</a><a id="766" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="771" class="Symbol">(</a><a id="772" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="777" href="Staged.Expression.Lambda.html#777" class="Bound">x</a><a id="778" class="Symbol">)</a>  <a id="781" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="783" href="Staged.Expression.Lambda.html#783" class="Bound">p</a><a id="784" class="Symbol">)</a> <a id="786" class="Symbol">=</a> <a id="788" href="Staged.Effects.Lambda.html#3472" class="Function">fetch</a> <a id="794" href="Staged.Expression.Lambda.html#777" class="Bound">x</a>
  <a id="798" href="Staged.Denote.Tree.html#1488" class="Field">denote</a> <a id="805" href="Staged.Expression.Lambda.html#613" class="Function">⟦lambda⟧</a> <a id="814" class="Symbol">(</a><a id="815" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="820" class="Symbol">(</a><a id="821" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="826" href="Staged.Expression.Lambda.html#826" class="Bound">y</a><a id="827" class="Symbol">)</a>  <a id="830" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="832" href="Staged.Expression.Lambda.html#832" class="Bound">p</a><a id="833" class="Symbol">)</a> <a id="835" class="Symbol">=</a> <a id="837" href="Staged.Effects.Lambda.html#3694" class="Function">abs</a> <a id="841" href="Staged.Expression.Lambda.html#826" class="Bound">y</a> <a id="843" class="Symbol">(</a><a id="844" href="Staged.Expression.Lambda.html#832" class="Bound">p</a> <a id="846" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="848" class="Symbol">)</a>
  <a id="852" href="Staged.Denote.Tree.html#1488" class="Field">denote</a> <a id="859" href="Staged.Expression.Lambda.html#613" class="Function">⟦lambda⟧</a> <a id="868" class="Symbol">(</a><a id="869" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="874" class="Symbol">(</a><a id="875" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="880" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="882" class="Symbol">)</a> <a id="884" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="886" href="Staged.Expression.Lambda.html#886" class="Bound">p</a><a id="887" class="Symbol">)</a> <a id="889" class="Symbol">=</a> <a id="891" class="Keyword">do</a>
    <a id="898" href="Staged.Expression.Lambda.html#898" class="Bound">v₁</a> <a id="901" href="Staged.Denote.Tree.html#991" class="Function Operator">←</a> <a id="903" href="Staged.Expression.Lambda.html#886" class="Bound">p</a> <a id="905" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="915" href="Staged.Expression.Lambda.html#915" class="Bound">v₂</a> <a id="918" href="Staged.Denote.Tree.html#991" class="Function Operator">←</a> <a id="920" href="Staged.Expression.Lambda.html#886" class="Bound">p</a> <a id="922" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="931" href="Staged.Effects.Lambda.html#3913" class="Function">app</a> <a id="935" href="Staged.Expression.Lambda.html#898" class="Bound">v₁</a> <a id="938" href="Staged.Expression.Lambda.html#915" class="Bound">v₂</a>
  <a id="943" href="Staged.Denote.Tree.html#1488" class="Field">denote</a> <a id="950" href="Staged.Expression.Lambda.html#613" class="Function">⟦lambda⟧</a> <a id="959" class="Symbol">(</a><a id="960" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="965" class="Symbol">(</a><a id="966" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="971" href="Staged.Expression.Lambda.html#971" class="Bound">y</a><a id="972" class="Symbol">)</a>  <a id="975" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="977" href="Staged.Expression.Lambda.html#977" class="Bound">p</a><a id="978" class="Symbol">)</a> <a id="980" class="Symbol">=</a> <a id="982" class="Keyword">do</a>
    <a id="989" href="Staged.Expression.Lambda.html#989" class="Bound">v</a> <a id="991" href="Staged.Denote.Tree.html#991" class="Function Operator">←</a> <a id="993" href="Staged.Expression.Lambda.html#977" class="Bound">p</a> <a id="995" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="1005" href="Staged.Effects.Lambda.html#4132" class="Function">letbind</a> <a id="1013" href="Staged.Expression.Lambda.html#971" class="Bound">y</a> <a id="1015" href="Staged.Expression.Lambda.html#989" class="Bound">v</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Staged.Expression.Lambda.html#977" class="Bound">p</a> <a id="1020" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="1024" class="Symbol">)</a>

<a id="1027" class="Keyword">module</a> <a id="1034" href="Staged.Expression.Lambda.html#1034" class="Module">_</a> <a id="1036" class="Keyword">where</a> 

  <a id="1046" href="Staged.Expression.Lambda.html#1046" class="Function">var&#39;</a> <a id="1051" class="Symbol">:</a> <a id="1053" class="Symbol">⦃</a> <a id="1055" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="1063" href="Container.html#769" class="Record Operator">≺</a> <a id="1065" href="Container.html#352" class="Generalizable">K</a> <a id="1067" class="Symbol">⦄</a> <a id="1069" class="Symbol">→</a> <a id="1071" href="Staged.Effects.Lambda.html#626" class="Function">Name</a> <a id="1076" class="Symbol">→</a> <a id="1078" href="Container.html#283" class="Datatype">μ</a> <a id="1080" href="Container.html#352" class="Generalizable">K</a>
  <a id="1084" href="Staged.Expression.Lambda.html#1046" class="Function">var&#39;</a> <a id="1089" href="Staged.Expression.Lambda.html#1089" class="Bound">x</a> <a id="1091" class="Symbol">=</a> <a id="1093" href="Container.html#1092" class="Function">inject</a> <a id="1100" class="Symbol">((</a><a id="1102" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1107" class="Symbol">(</a><a id="1108" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1113" href="Staged.Expression.Lambda.html#1089" class="Bound">x</a><a id="1114" class="Symbol">))</a> <a id="1117" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1119" class="Symbol">λ())</a>

  <a id="1127" href="Staged.Expression.Lambda.html#1127" class="Function">abs&#39;</a> <a id="1132" class="Symbol">:</a> <a id="1134" class="Symbol">⦃</a> <a id="1136" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="1144" href="Container.html#769" class="Record Operator">≺</a> <a id="1146" href="Container.html#352" class="Generalizable">K</a> <a id="1148" class="Symbol">⦄</a> <a id="1150" class="Symbol">→</a> <a id="1152" href="Staged.Effects.Lambda.html#626" class="Function">Name</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Container.html#283" class="Datatype">μ</a> <a id="1161" href="Container.html#352" class="Generalizable">K</a> <a id="1163" class="Symbol">→</a> <a id="1165" href="Container.html#283" class="Datatype">μ</a> <a id="1167" href="Container.html#352" class="Generalizable">K</a>
  <a id="1171" href="Staged.Expression.Lambda.html#1127" class="Function">abs&#39;</a> <a id="1176" href="Staged.Expression.Lambda.html#1176" class="Bound">x</a> <a id="1178" href="Staged.Expression.Lambda.html#1178" class="Bound">e</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="Container.html#1092" class="Function">inject</a> <a id="1189" class="Symbol">((</a><a id="1191" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1196" class="Symbol">(</a><a id="1197" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1202" href="Staged.Expression.Lambda.html#1176" class="Bound">x</a><a id="1203" class="Symbol">))</a> <a id="1206" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1208" class="Symbol">λ</a> <a id="1210" href="Staged.Expression.Lambda.html#1210" class="Bound">_</a> <a id="1212" class="Symbol">→</a> <a id="1214" href="Staged.Expression.Lambda.html#1178" class="Bound">e</a><a id="1215" class="Symbol">)</a>

  <a id="1220" href="Staged.Expression.Lambda.html#1220" class="Function">app&#39;</a> <a id="1225" class="Symbol">:</a> <a id="1227" class="Symbol">⦃</a> <a id="1229" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="1237" href="Container.html#769" class="Record Operator">≺</a> <a id="1239" href="Container.html#352" class="Generalizable">K</a> <a id="1241" class="Symbol">⦄</a> <a id="1243" class="Symbol">→</a> <a id="1245" href="Container.html#283" class="Datatype">μ</a> <a id="1247" href="Container.html#352" class="Generalizable">K</a> <a id="1249" class="Symbol">→</a> <a id="1251" href="Container.html#283" class="Datatype">μ</a> <a id="1253" href="Container.html#352" class="Generalizable">K</a> <a id="1255" class="Symbol">→</a> <a id="1257" href="Container.html#283" class="Datatype">μ</a> <a id="1259" href="Container.html#352" class="Generalizable">K</a>
  <a id="1263" href="Staged.Expression.Lambda.html#1220" class="Function">app&#39;</a> <a id="1268" href="Staged.Expression.Lambda.html#1268" class="Bound">e₁</a> <a id="1271" href="Staged.Expression.Lambda.html#1271" class="Bound">e₂</a> <a id="1274" class="Symbol">=</a> <a id="1276" href="Container.html#1092" class="Function">inject</a> <a id="1283" class="Symbol">((</a><a id="1285" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1290" class="Symbol">(</a><a id="1291" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1296" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="1298" class="Symbol">))</a> <a id="1301" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1303" class="Symbol">λ</a> <a id="1305" class="Symbol">{</a> <a id="1307" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1313" class="Symbol">→</a> <a id="1315" href="Staged.Expression.Lambda.html#1268" class="Bound">e₁</a> <a id="1318" class="Symbol">;</a> <a id="1320" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1325" class="Symbol">→</a> <a id="1327" href="Staged.Expression.Lambda.html#1271" class="Bound">e₂</a> <a id="1330" class="Symbol">})</a>

  <a id="1336" href="Staged.Expression.Lambda.html#1336" class="Function">let&#39;</a> <a id="1341" class="Symbol">:</a> <a id="1343" class="Symbol">⦃</a> <a id="1345" href="Staged.Expression.Lambda.html#316" class="Function">LamExpr</a> <a id="1353" href="Container.html#769" class="Record Operator">≺</a> <a id="1355" href="Container.html#352" class="Generalizable">K</a> <a id="1357" class="Symbol">⦄</a> <a id="1359" class="Symbol">→</a> <a id="1361" href="Staged.Effects.Lambda.html#626" class="Function">Name</a> <a id="1366" class="Symbol">→</a> <a id="1368" href="Container.html#283" class="Datatype">μ</a> <a id="1370" href="Container.html#352" class="Generalizable">K</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="Container.html#283" class="Datatype">μ</a> <a id="1376" href="Container.html#352" class="Generalizable">K</a> <a id="1378" class="Symbol">→</a> <a id="1380" href="Container.html#283" class="Datatype">μ</a> <a id="1382" href="Container.html#352" class="Generalizable">K</a>
  <a id="1386" href="Staged.Expression.Lambda.html#1336" class="Function">let&#39;</a> <a id="1391" href="Staged.Expression.Lambda.html#1391" class="Bound">x</a> <a id="1393" href="Staged.Expression.Lambda.html#1393" class="Bound">e₁</a> <a id="1396" href="Staged.Expression.Lambda.html#1396" class="Bound">e₂</a> <a id="1399" class="Symbol">=</a> <a id="1401" href="Container.html#1092" class="Function">inject</a> <a id="1408" class="Symbol">((</a><a id="1410" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1421" href="Staged.Expression.Lambda.html#1391" class="Bound">x</a><a id="1422" class="Symbol">))</a> <a id="1425" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1427" class="Symbol">λ</a> <a id="1429" class="Symbol">{</a> <a id="1431" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1437" class="Symbol">→</a> <a id="1439" href="Staged.Expression.Lambda.html#1393" class="Bound">e₁</a> <a id="1442" class="Symbol">;</a> <a id="1444" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1449" class="Symbol">→</a> <a id="1451" href="Staged.Expression.Lambda.html#1396" class="Bound">e₂</a>  <a id="1455" class="Symbol">})</a>
</pre></body></html>