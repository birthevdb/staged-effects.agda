<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Expression.State</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Expression.State.html" class="Module">Expression.State</a> <a id="25" class="Symbol">(</a><a id="26" href="Expression.State.html#26" class="Bound">St</a> <a id="29" class="Symbol">:</a> <a id="31" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="34" class="Symbol">)</a> <a id="36" class="Keyword">where</a>

<a id="43" class="Keyword">open</a> <a id="48" class="Keyword">import</a> <a id="55" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.Product.html" class="Module">Data.Product</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="179" class="Keyword">hiding</a> <a id="186" class="Symbol">(</a><a id="187" href="Data.Maybe.Base.html#2246" class="Function Operator">_&gt;&gt;=_</a><a id="192" class="Symbol">)</a>

<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Denote.Sig.html" class="Module">Denote.Sig</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Denote.StagedSig.html" class="Module">Denote.StagedSig</a>
<a id="247" class="Keyword">open</a> <a id="252" class="Keyword">import</a> <a id="259" href="Denote.Tree.html" class="Module">Denote.Tree</a>

<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Effects.State.html" class="Module">Effects.State</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Value.Core.html" class="Module">Value.Core</a>

<a id="323" class="Keyword">module</a> <a id="330" href="Expression.State.html#330" class="Module">_</a> <a id="332" class="Symbol">{</a><a id="333" href="Expression.State.html#333" class="Bound">V</a> <a id="335" class="Symbol">:</a> <a id="337" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="340" class="Symbol">}</a> <a id="342" class="Keyword">where</a> 

  <a id="352" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="362" class="Symbol">:</a> <a id="364" href="Denote.Sig.html#327" class="Record">Sig</a>
  <a id="370" href="Denote.Sig.html#374" class="Field">Sig.S</a> <a id="376" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="386" class="Symbol">=</a> <a id="388" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="395" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="401" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="411" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="417" class="Symbol">=</a> <a id="419" href="Data.Empty.html#526" class="Datatype">⊥</a>  <a id="422" class="Comment">-- get</a>
  <a id="431" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="437" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="447" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="453" class="Symbol">=</a> <a id="455" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>  <a id="458" class="Comment">-- put e</a>

  <a id="470" class="Keyword">postulate</a> <a id="480" href="Expression.State.html#480" class="Postulate">ERROR</a> <a id="486" class="Symbol">:</a> <a id="488" class="Symbol">∀</a> <a id="490" class="Symbol">{</a><a id="491" href="Expression.State.html#491" class="Bound">A</a> <a id="493" class="Symbol">:</a> <a id="495" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="499" href="Denote.Sig.html#307" class="Generalizable">ℓ</a><a id="500" class="Symbol">}</a> <a id="502" class="Symbol">→</a> <a id="504" href="Expression.State.html#491" class="Bound">A</a>

  <a id="509" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="517" class="Symbol">:</a>   <a id="521" class="Symbol">⦃</a> <a id="523" href="Effects.State.html#508" class="Function">StateSig</a> <a id="532" href="Expression.State.html#26" class="Bound">St</a> <a id="535" href="Denote.StagedSig.html#784" class="Record Operator">⊏</a> <a id="537" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="539" class="Symbol">⦄</a>
            <a id="553" class="Symbol">→</a> <a id="555" class="Symbol">⦃</a> <a id="557" href="Expression.State.html#26" class="Bound">St</a> <a id="560" href="Value.Core.html#75" class="Record Operator">`⊏</a> <a id="563" href="Expression.State.html#333" class="Bound">V</a> <a id="565" class="Symbol">⦄</a>
              <a id="581" class="Comment">--------------------</a>
            <a id="614" class="Symbol">→</a> <a id="616" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="626" href="Denote.Tree.html#1380" class="Record Operator">⟨</a> <a id="628" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="630" href="Denote.Tree.html#1380" class="Record Operator">⟩⇒</a> <a id="633" href="Expression.State.html#333" class="Bound">V</a>

  <a id="638" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="645" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="653" class="Symbol">(</a><a id="654" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="660" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="662" class="Symbol">_)</a> <a id="665" class="Symbol">=</a> <a id="667" class="Keyword">do</a>
    <a id="674" href="Expression.State.html#674" class="Bound">n</a> <a id="676" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="678" href="Effects.State.html#1100" class="Function">get</a>
    <a id="686" href="Denote.Tree.html#1261" class="Function">return</a> <a id="693" class="Symbol">(</a><a id="694" href="Value.Core.html#117" class="Field">inject</a> <a id="701" href="Expression.State.html#674" class="Bound">n</a><a id="702" class="Symbol">)</a>
  <a id="706" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="713" href="Expression.State.html#509" class="Function">⟦state⟧</a> <a id="721" class="Symbol">(</a><a id="722" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="730" href="Expression.State.html#730" class="Bound">p</a><a id="731" class="Symbol">)</a> <a id="733" class="Symbol">=</a> <a id="735" class="Keyword">do</a>
    <a id="742" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="747" href="Expression.State.html#747" class="Bound">n</a> <a id="749" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="751" href="Denote.Tree.html#585" class="Function">mapᵀ</a> <a id="756" href="Value.Core.html#145" class="Field">project</a> <a id="764" class="Symbol">(</a><a id="765" href="Expression.State.html#730" class="Bound">p</a> <a id="767" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="769" class="Symbol">)</a>
      <a id="777" class="Keyword">where</a> <a id="783" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="791" class="Symbol">→</a> <a id="793" href="Expression.State.html#480" class="Postulate">ERROR</a>
    <a id="803" href="Effects.State.html#1295" class="Function">put</a> <a id="807" href="Expression.State.html#747" class="Bound">n</a>
    <a id="813" href="Denote.Tree.html#1261" class="Function">return</a> <a id="820" class="Symbol">(</a><a id="821" href="Value.Core.html#117" class="Field">inject</a> <a id="828" href="Expression.State.html#747" class="Bound">n</a><a id="829" class="Symbol">)</a>

  <a id="834" href="Expression.State.html#834" class="Function">getᴱ</a> <a id="839" class="Symbol">:</a> <a id="841" class="Symbol">⦃</a> <a id="843" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="853" href="Denote.Sig.html#1392" class="Function Operator">⊰</a> <a id="855" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="857" class="Symbol">⦄</a> <a id="859" class="Symbol">→</a> <a id="861" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="863" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="867" href="Expression.State.html#834" class="Function">getᴱ</a> <a id="872" class="Symbol">=</a> <a id="874" href="Denote.Sig.html#1465" class="Function">injectᶜ</a> <a id="882" class="Symbol">(</a><a id="883" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="889" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="891" class="Symbol">λ())</a>

  <a id="899" href="Expression.State.html#899" class="Function">putᴱ</a> <a id="904" class="Symbol">:</a> <a id="906" class="Symbol">⦃</a> <a id="908" href="Expression.State.html#352" class="Function">StateExpr</a> <a id="918" href="Denote.Sig.html#1392" class="Function Operator">⊰</a> <a id="920" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="922" class="Symbol">⦄</a> <a id="924" class="Symbol">→</a> <a id="926" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="928" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="930" class="Symbol">→</a> <a id="932" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="934" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="938" href="Expression.State.html#899" class="Function">putᴱ</a> <a id="943" href="Expression.State.html#943" class="Bound">e</a> <a id="945" class="Symbol">=</a> <a id="947" href="Denote.Sig.html#1465" class="Function">injectᶜ</a> <a id="955" class="Symbol">(</a><a id="956" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="961" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="963" class="Symbol">(λ</a> <a id="966" href="Expression.State.html#966" class="Bound">_</a> <a id="968" class="Symbol">→</a> <a id="970" href="Expression.State.html#943" class="Bound">e</a><a id="971" class="Symbol">))</a>
</pre></body></html>