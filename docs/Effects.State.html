<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Effects.State</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--type-in-type</a> <a id="28" class="Symbol">#-}</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Effects.State.html" class="Module">Effects.State</a> <a id="54" class="Keyword">where</a>

<a id="61" class="Keyword">open</a> <a id="66" class="Keyword">import</a> <a id="73" href="Function.html" class="Module">Function</a>

<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Product.html" class="Module">Data.Product</a>
<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.List.html" class="Module">Data.List</a>

<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Denote.Sig.html" class="Module">Denote.Sig</a>
<a id="220" class="Keyword">open</a> <a id="225" class="Keyword">import</a> <a id="232" href="Denote.StagedSig.html" class="Module">Denote.StagedSig</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Denote.Tree.html" class="Module">Denote.Tree</a>

<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Category.Functor.html" class="Module">Category.Functor</a>

<a id="355" class="Keyword">module</a> <a id="362" href="Effects.State.html#362" class="Module">_</a> <a id="364" class="Keyword">where</a>

  <a id="373" class="Keyword">open</a> <a id="378" href="Category.Functor.html#499" class="Module">RawFunctor</a> <a id="389" class="Symbol">⦃...⦄</a>
  <a id="397" class="Keyword">open</a> <a id="402" href="Denote.StagedSig.html#274" class="Module">StagedSig</a>

  <a id="415" class="Keyword">data</a> <a id="420" href="Effects.State.html#420" class="Datatype">StateCmd</a> <a id="429" class="Symbol">(</a><a id="430" href="Effects.State.html#430" class="Bound">S</a> <a id="432" class="Symbol">:</a> <a id="434" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="437" class="Symbol">)</a> <a id="439" class="Symbol">:</a> <a id="441" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="445" class="Keyword">where</a>
    <a id="455" href="Effects.State.html#455" class="InductiveConstructor">`get</a> <a id="460" class="Symbol">:</a> <a id="462" href="Effects.State.html#420" class="Datatype">StateCmd</a> <a id="471" href="Effects.State.html#430" class="Bound">S</a>
    <a id="477" href="Effects.State.html#477" class="InductiveConstructor">`put</a> <a id="482" class="Symbol">:</a> <a id="484" class="Symbol">(</a><a id="485" href="Effects.State.html#485" class="Bound">s</a> <a id="487" class="Symbol">:</a> <a id="489" href="Effects.State.html#430" class="Bound">S</a><a id="490" class="Symbol">)</a> <a id="492" class="Symbol">→</a> <a id="494" href="Effects.State.html#420" class="Datatype">StateCmd</a> <a id="503" href="Effects.State.html#430" class="Bound">S</a>

  <a id="508" href="Effects.State.html#508" class="Function">StateSig</a> <a id="517" class="Symbol">:</a> <a id="519" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="523" class="Symbol">→</a> <a id="525" href="Denote.StagedSig.html#274" class="Record">StagedSig</a>
  <a id="537" href="Denote.StagedSig.html#333" class="Field">C</a> <a id="539" class="Symbol">(</a><a id="540" href="Effects.State.html#508" class="Function">StateSig</a> <a id="549" href="Effects.State.html#549" class="Bound">S</a><a id="550" class="Symbol">)</a> <a id="552" class="Symbol">=</a> <a id="554" href="Effects.State.html#420" class="Datatype">StateCmd</a> <a id="563" href="Effects.State.html#549" class="Bound">S</a>
  <a id="567" href="Denote.StagedSig.html#351" class="Field">R</a> <a id="569" class="Symbol">(</a><a id="570" href="Effects.State.html#508" class="Function">StateSig</a> <a id="579" href="Effects.State.html#579" class="Bound">S</a><a id="580" class="Symbol">)</a> <a id="582" href="Effects.State.html#455" class="InductiveConstructor">`get</a> <a id="587" class="Symbol">=</a> <a id="589" href="Effects.State.html#579" class="Bound">S</a>
  <a id="593" href="Denote.StagedSig.html#351" class="Field">R</a> <a id="595" class="Symbol">(</a><a id="596" href="Effects.State.html#508" class="Function">StateSig</a> <a id="605" href="Effects.State.html#605" class="Bound">S</a><a id="606" class="Symbol">)</a> <a id="608" class="Symbol">(</a><a id="609" href="Effects.State.html#477" class="InductiveConstructor">`put</a> <a id="614" href="Effects.State.html#614" class="Bound">s</a><a id="615" class="Symbol">)</a> <a id="617" class="Symbol">=</a> <a id="619" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="623" href="Denote.StagedSig.html#373" class="Field">Z</a> <a id="625" class="Symbol">(</a><a id="626" href="Effects.State.html#508" class="Function">StateSig</a> <a id="635" href="Effects.State.html#635" class="Bound">S</a><a id="636" class="Symbol">)</a> <a id="638" class="Symbol">_</a> <a id="640" class="Symbol">=</a> <a id="642" href="Data.Empty.html#526" class="Datatype">⊥</a>

  <a id="647" class="Keyword">variable</a> <a id="656" href="Effects.State.html#656" class="Generalizable">S</a> <a id="658" class="Symbol">:</a> <a id="660" href="Agda.Primitive.html#326" class="Primitive">Set</a>

  <a id="667" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="673" class="Symbol">:</a>  <a id="676" class="Symbol">⦃</a> <a id="678" href="Category.Functor.html#499" class="Record">RawFunctor</a> <a id="689" href="Denote.Tree.html#179" class="Generalizable">L</a> <a id="691" class="Symbol">⦄</a> <a id="693" class="Symbol">→</a>
           <a id="706" href="Effects.State.html#656" class="Generalizable">S</a> <a id="708" class="Symbol">→</a> <a id="710" href="Denote.Tree.html#202" class="Datatype">Tree</a> <a id="715" href="Denote.Tree.html#179" class="Generalizable">L</a> <a id="717" class="Symbol">(</a><a id="718" href="Effects.State.html#508" class="Function">StateSig</a> <a id="727" href="Effects.State.html#656" class="Generalizable">S</a> <a id="729" href="Denote.StagedSig.html#454" class="Function Operator">⊞</a> <a id="731" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a><a id="732" class="Symbol">)</a> <a id="734" href="Denote.Sig.html#598" class="Generalizable">A</a> <a id="736" class="Symbol">→</a>
           <a id="749" href="Denote.Tree.html#202" class="Datatype">Tree</a> <a id="754" class="Symbol">((</a><a id="756" href="Effects.State.html#656" class="Generalizable">S</a> <a id="758" href="Data.Product.html#1167" class="Function Operator">×_</a><a id="760" class="Symbol">)</a> <a id="762" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="764" href="Denote.Tree.html#179" class="Generalizable">L</a><a id="765" class="Symbol">)</a> <a id="767" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="769" class="Symbol">(</a><a id="770" href="Effects.State.html#656" class="Generalizable">S</a> <a id="772" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="774" href="Denote.Sig.html#598" class="Generalizable">A</a><a id="775" class="Symbol">)</a>
  <a id="779" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="785" href="Effects.State.html#785" class="Bound">s</a> <a id="787" class="Symbol">(</a><a id="788" href="Denote.Tree.html#267" class="InductiveConstructor">leaf</a> <a id="793" href="Effects.State.html#793" class="Bound">x</a><a id="794" class="Symbol">)</a> <a id="796" class="Symbol">=</a> <a id="798" href="Denote.Tree.html#267" class="InductiveConstructor">leaf</a> <a id="803" class="Symbol">(</a><a id="804" href="Effects.State.html#785" class="Bound">s</a> <a id="806" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="808" href="Effects.State.html#793" class="Bound">x</a><a id="809" class="Symbol">)</a>
  <a id="813" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="819" href="Effects.State.html#819" class="Bound">s</a> <a id="821" class="Symbol">(</a><a id="822" href="Denote.Tree.html#294" class="InductiveConstructor">node</a> <a id="827" class="Symbol">(</a><a id="828" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="833" href="Effects.State.html#455" class="InductiveConstructor">`get</a><a id="837" class="Symbol">)</a> <a id="839" href="Effects.State.html#839" class="Bound">l</a> <a id="841" class="Symbol">_</a> <a id="843" href="Effects.State.html#843" class="Bound">k</a><a id="844" class="Symbol">)</a> <a id="846" class="Symbol">=</a> <a id="848" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="854" href="Effects.State.html#819" class="Bound">s</a> <a id="856" class="Symbol">(</a><a id="857" href="Effects.State.html#843" class="Bound">k</a> <a id="859" class="Symbol">(</a><a id="860" href="Function.Base.html#636" class="Function">const</a> <a id="866" href="Effects.State.html#819" class="Bound">s</a> <a id="868" href="Category.Functor.html#608" class="Field Operator">&lt;$&gt;</a> <a id="872" href="Effects.State.html#839" class="Bound">l</a><a id="873" class="Symbol">))</a>
  <a id="878" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="884" class="Symbol">_</a> <a id="886" class="Symbol">(</a><a id="887" href="Denote.Tree.html#294" class="InductiveConstructor">node</a> <a id="892" class="Symbol">(</a><a id="893" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="898" class="Symbol">(</a><a id="899" href="Effects.State.html#477" class="InductiveConstructor">`put</a> <a id="904" href="Effects.State.html#904" class="Bound">s</a><a id="905" class="Symbol">))</a> <a id="908" href="Effects.State.html#908" class="Bound">l</a> <a id="910" class="Symbol">_</a> <a id="912" href="Effects.State.html#912" class="Bound">k</a><a id="913" class="Symbol">)</a> <a id="915" class="Symbol">=</a> <a id="917" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="923" href="Effects.State.html#904" class="Bound">s</a> <a id="925" class="Symbol">(</a><a id="926" href="Effects.State.html#912" class="Bound">k</a> <a id="928" href="Effects.State.html#908" class="Bound">l</a><a id="929" class="Symbol">)</a>
  <a id="933" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="939" href="Effects.State.html#939" class="Bound">s</a> <a id="941" class="Symbol">(</a><a id="942" href="Denote.Tree.html#294" class="InductiveConstructor">node</a> <a id="947" class="Symbol">(</a><a id="948" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="953" href="Effects.State.html#953" class="Bound">c</a><a id="954" class="Symbol">)</a> <a id="956" href="Effects.State.html#956" class="Bound">l</a> <a id="958" href="Effects.State.html#958" class="Bound">st</a> <a id="961" href="Effects.State.html#961" class="Bound">k</a><a id="962" class="Symbol">)</a> <a id="964" class="Symbol">=</a>
    <a id="970" href="Denote.Tree.html#294" class="InductiveConstructor">node</a>  <a id="976" href="Effects.State.html#953" class="Bound">c</a> <a id="978" class="Symbol">(</a><a id="979" href="Effects.State.html#939" class="Bound">s</a> <a id="981" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="983" href="Effects.State.html#956" class="Bound">l</a><a id="984" class="Symbol">)</a>
          <a id="996" class="Symbol">(λ{</a> <a id="1000" href="Effects.State.html#1000" class="Bound">z</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Effects.State.html#1003" class="Bound">s&#39;</a> <a id="1006" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1008" href="Effects.State.html#1008" class="Bound">l</a><a id="1009" class="Symbol">)</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="1019" href="Effects.State.html#1003" class="Bound">s&#39;</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Effects.State.html#958" class="Bound">st</a> <a id="1026" href="Effects.State.html#1000" class="Bound">z</a> <a id="1028" href="Effects.State.html#1008" class="Bound">l</a><a id="1029" class="Symbol">)</a> <a id="1031" class="Symbol">})</a>
          <a id="1044" class="Symbol">(λ{</a> <a id="1048" class="Symbol">(</a><a id="1049" href="Effects.State.html#1049" class="Bound">s&#39;</a> <a id="1052" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1054" href="Effects.State.html#1054" class="Bound">lr</a><a id="1056" class="Symbol">)</a> <a id="1058" class="Symbol">→</a> <a id="1060" href="Effects.State.html#667" class="Function">hSt&#39;&#39;</a> <a id="1066" href="Effects.State.html#1049" class="Bound">s&#39;</a> <a id="1069" class="Symbol">(</a><a id="1070" href="Effects.State.html#961" class="Bound">k</a> <a id="1072" href="Effects.State.html#1054" class="Bound">lr</a><a id="1074" class="Symbol">)</a> <a id="1076" class="Symbol">})</a>

  <a id="1082" class="Keyword">open</a> <a id="1087" href="Denote.StagedSig.html#784" class="Module Operator">_⊏_</a> <a id="1091" class="Symbol">⦃...⦄</a>

  <a id="1100" href="Effects.State.html#1100" class="Function">get</a> <a id="1104" class="Symbol">:</a> <a id="1106" class="Symbol">⦃</a> <a id="1108" href="Effects.State.html#508" class="Function">StateSig</a> <a id="1117" href="Effects.State.html#656" class="Generalizable">S</a> <a id="1119" href="Denote.StagedSig.html#784" class="Record Operator">⊏</a> <a id="1121" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="1123" class="Symbol">⦄</a> <a id="1125" class="Symbol">→</a> <a id="1127" href="Denote.Tree.html#202" class="Datatype">Tree</a> <a id="1132" href="Function.Base.html#615" class="Function">id</a> <a id="1135" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="1137" href="Effects.State.html#656" class="Generalizable">S</a>
  <a id="1141" href="Effects.State.html#1100" class="Function">get</a> <a id="1145" class="Symbol">⦃</a> <a id="1147" href="Effects.State.html#1147" class="Bound">w</a> <a id="1149" class="Symbol">⦄</a> <a id="1151" class="Symbol">=</a> <a id="1153" href="Denote.Tree.html#294" class="InductiveConstructor">node</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Denote.StagedSig.html#852" class="Field">inj</a> <a id="1163" href="Effects.State.html#455" class="InductiveConstructor">`get</a><a id="1167" class="Symbol">)</a> <a id="1169" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
                   <a id="1191" class="Symbol">(λ</a> <a id="1194" href="Effects.State.html#1194" class="Bound">z</a> <a id="1196" href="Effects.State.html#1196" class="Bound">_</a> <a id="1198" class="Symbol">→</a> <a id="1200" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="1214" href="Function.Base.html#615" class="Function">id</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Denote.StagedSig.html#932" class="Field">Z≡</a> <a id="1221" class="Symbol">⦃</a> <a id="1223" href="Effects.State.html#1147" class="Bound">w</a> <a id="1225" class="Symbol">⦄)</a> <a id="1228" href="Effects.State.html#1194" class="Bound">z</a><a id="1229" class="Symbol">))</a>
                   <a id="1251" class="Symbol">(λ</a> <a id="1254" href="Effects.State.html#1254" class="Bound">r</a>   <a id="1258" class="Symbol">→</a> <a id="1260" href="Denote.Tree.html#1261" class="Function">return</a> <a id="1267" class="Symbol">(</a><a id="1268" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="1274" href="Function.Base.html#615" class="Function">id</a> <a id="1277" class="Symbol">(</a><a id="1278" href="Denote.StagedSig.html#882" class="Field">R≡</a> <a id="1281" class="Symbol">⦃</a> <a id="1283" href="Effects.State.html#1147" class="Bound">w</a> <a id="1285" class="Symbol">⦄)</a> <a id="1288" href="Effects.State.html#1254" class="Bound">r</a><a id="1289" class="Symbol">))</a>

  <a id="1295" href="Effects.State.html#1295" class="Function">put</a> <a id="1299" class="Symbol">:</a> <a id="1301" class="Symbol">⦃</a> <a id="1303" href="Effects.State.html#508" class="Function">StateSig</a> <a id="1312" href="Effects.State.html#656" class="Generalizable">S</a> <a id="1314" href="Denote.StagedSig.html#784" class="Record Operator">⊏</a> <a id="1316" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="1318" class="Symbol">⦄</a> <a id="1320" class="Symbol">→</a> <a id="1322" href="Effects.State.html#656" class="Generalizable">S</a> <a id="1324" class="Symbol">→</a> <a id="1326" href="Denote.Tree.html#202" class="Datatype">Tree</a> <a id="1331" href="Function.Base.html#615" class="Function">id</a> <a id="1334" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="1336" href="Effects.State.html#656" class="Generalizable">S</a>
  <a id="1340" href="Effects.State.html#1295" class="Function">put</a> <a id="1344" class="Symbol">{</a><a id="1345" class="Argument">S</a> <a id="1347" class="Symbol">=</a> <a id="1349" href="Effects.State.html#1349" class="Bound">S</a><a id="1350" class="Symbol">}</a> <a id="1352" class="Symbol">⦃</a> <a id="1354" href="Effects.State.html#1354" class="Bound">w</a> <a id="1356" class="Symbol">⦄</a> <a id="1358" href="Effects.State.html#1358" class="Bound">s</a> <a id="1360" class="Symbol">=</a> <a id="1362" href="Denote.Tree.html#294" class="InductiveConstructor">node</a> <a id="1367" class="Symbol">(</a><a id="1368" href="Denote.StagedSig.html#852" class="Field">inj</a> <a id="1372" class="Symbol">(</a><a id="1373" href="Effects.State.html#477" class="InductiveConstructor">`put</a> <a id="1378" href="Effects.State.html#1358" class="Bound">s</a><a id="1379" class="Symbol">))</a> <a id="1382" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
               <a id="1400" class="Symbol">(λ</a> <a id="1403" href="Effects.State.html#1403" class="Bound">z</a> <a id="1405" href="Effects.State.html#1405" class="Bound">_</a> <a id="1407" class="Symbol">→</a> <a id="1409" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="1416" class="Symbol">(</a><a id="1417" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="1423" href="Function.Base.html#615" class="Function">id</a> <a id="1426" class="Symbol">(</a><a id="1427" href="Denote.StagedSig.html#932" class="Field">Z≡</a> <a id="1430" class="Symbol">⦃</a> <a id="1432" href="Effects.State.html#1354" class="Bound">w</a> <a id="1434" class="Symbol">⦄)</a> <a id="1437" href="Effects.State.html#1403" class="Bound">z</a><a id="1438" class="Symbol">))</a>
               <a id="1456" class="Symbol">(</a><a id="1457" href="Function.Base.html#636" class="Function">const</a> <a id="1463" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1465" href="Denote.Tree.html#1261" class="Function">return</a> <a id="1472" href="Effects.State.html#1358" class="Bound">s</a><a id="1473" class="Symbol">)</a> 
</pre></body></html>