<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Expression.State</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Expression.State.html" class="Module">Expression.State</a> <a id="25" class="Symbol">(</a><a id="26" href="Expression.State.html#26" class="Bound">St</a> <a id="29" class="Symbol">:</a> <a id="31" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="34" class="Symbol">)</a> <a id="36" class="Keyword">where</a>

<a id="43" class="Keyword">open</a> <a id="48" class="Keyword">import</a> <a id="55" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.Product.html" class="Module">Data.Product</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="179" class="Keyword">hiding</a> <a id="186" class="Symbol">(</a><a id="187" href="Data.Maybe.Base.html#2246" class="Function Operator">_&gt;&gt;=_</a><a id="192" class="Symbol">)</a>

<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Denote.Sig.html" class="Module">Denote.Sig</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Denote.StagedSig.html" class="Module">Denote.StagedSig</a>
<a id="247" class="Keyword">open</a> <a id="252" class="Keyword">import</a> <a id="259" href="Denote.Tree.html" class="Module">Denote.Tree</a>

<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Effects.State.html" class="Module">Effects.State</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Value.Core.html" class="Module">Value.Core</a>

<a id="323" class="Keyword">module</a> <a id="330" href="Expression.State.html#330" class="Module">_</a> <a id="332" class="Keyword">where</a> 

  <a id="342" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="352" class="Symbol">:</a> <a id="354" href="Denote.Sig.html#327" class="Record">Sig</a>
  <a id="360" href="Denote.Sig.html#374" class="Field">Sig.S</a> <a id="366" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="376" class="Symbol">=</a> <a id="378" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="385" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="391" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="401" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="407" class="Symbol">=</a> <a id="409" href="Data.Empty.html#526" class="Datatype">⊥</a>  <a id="412" class="Comment">-- get</a>
  <a id="421" href="Denote.Sig.html#392" class="Field">Sig.P</a> <a id="427" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="437" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="443" class="Symbol">=</a> <a id="445" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>  <a id="448" class="Comment">-- put e</a>

<a id="458" class="Keyword">module</a> <a id="465" href="Expression.State.html#465" class="Module">_</a> <a id="467" class="Symbol">{</a><a id="468" href="Expression.State.html#468" class="Bound">V</a> <a id="470" class="Symbol">:</a> <a id="472" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="475" class="Symbol">}</a> <a id="477" class="Keyword">where</a> 

  <a id="487" class="Keyword">postulate</a> <a id="497" href="Expression.State.html#497" class="Postulate">ERROR</a> <a id="503" class="Symbol">:</a> <a id="505" class="Symbol">∀</a> <a id="507" class="Symbol">{</a><a id="508" href="Expression.State.html#508" class="Bound">A</a> <a id="510" class="Symbol">:</a> <a id="512" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="516" href="Denote.Sig.html#307" class="Generalizable">ℓ</a><a id="517" class="Symbol">}</a> <a id="519" class="Symbol">→</a> <a id="521" href="Expression.State.html#508" class="Bound">A</a>

  <a id="526" href="Expression.State.html#526" class="Function">⟦state⟧</a> <a id="534" class="Symbol">:</a>   <a id="538" class="Symbol">⦃</a> <a id="540" href="Effects.State.html#508" class="Function">StateSig</a> <a id="549" href="Expression.State.html#26" class="Bound">St</a> <a id="552" href="Denote.StagedSig.html#784" class="Record Operator">⊏</a> <a id="554" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="556" class="Symbol">⦄</a>
            <a id="570" class="Symbol">→</a> <a id="572" class="Symbol">⦃</a> <a id="574" href="Expression.State.html#26" class="Bound">St</a> <a id="577" href="Value.Core.html#118" class="Record Operator">⊂</a> <a id="579" href="Expression.State.html#468" class="Bound">V</a> <a id="581" class="Symbol">⦄</a>
              <a id="597" class="Comment">--------------------</a>
            <a id="630" class="Symbol">→</a> <a id="632" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="642" href="Denote.Tree.html#1380" class="Record Operator">⟨</a> <a id="644" href="Denote.StagedSig.html#1057" class="Generalizable">ζ</a> <a id="646" href="Denote.Tree.html#1380" class="Record Operator">⟩⇒</a> <a id="649" href="Expression.State.html#468" class="Bound">V</a>

  <a id="654" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="661" href="Expression.State.html#526" class="Function">⟦state⟧</a> <a id="669" class="Symbol">(</a><a id="670" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="676" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="678" class="Symbol">_)</a> <a id="681" class="Symbol">=</a> <a id="683" class="Keyword">do</a>
    <a id="690" href="Expression.State.html#690" class="Bound">n</a> <a id="692" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="694" href="Effects.State.html#1100" class="Function">get</a>
    <a id="702" href="Denote.Tree.html#1261" class="Function">return</a> <a id="709" class="Symbol">(</a><a id="710" href="Value.Core.html#159" class="Field">inject</a> <a id="717" href="Expression.State.html#690" class="Bound">n</a><a id="718" class="Symbol">)</a>
  <a id="722" href="Denote.Tree.html#1446" class="Field">denote</a> <a id="729" class="Symbol">(</a><a id="730" href="Expression.State.html#526" class="Function">⟦state⟧</a> <a id="738" class="Symbol">⦃</a> <a id="740" class="Symbol">_</a> <a id="742" class="Symbol">⦄</a> <a id="744" class="Symbol">⦃</a> <a id="746" href="Expression.State.html#746" class="Bound">w</a> <a id="748" class="Symbol">⦄)</a> <a id="751" class="Symbol">(</a><a id="752" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="758" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="760" href="Expression.State.html#760" class="Bound">p</a><a id="761" class="Symbol">)</a> <a id="763" class="Symbol">=</a> <a id="765" class="Keyword">do</a>
    <a id="772" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="777" href="Expression.State.html#777" class="Bound">n</a> <a id="779" href="Denote.Tree.html#949" class="Function Operator">←</a> <a id="781" href="Denote.Tree.html#585" class="Function">mapᵀ</a> <a id="786" class="Symbol">(</a><a id="787" href="Value.Core.html#187" class="Field">project</a> <a id="795" class="Symbol">⦃</a> <a id="797" href="Expression.State.html#746" class="Bound">w</a> <a id="799" class="Symbol">⦄)</a> <a id="802" class="Symbol">(</a><a id="803" href="Expression.State.html#760" class="Bound">p</a> <a id="805" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="807" class="Symbol">)</a>
      <a id="815" class="Keyword">where</a> <a id="821" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="829" class="Symbol">→</a> <a id="831" href="Expression.State.html#497" class="Postulate">ERROR</a>
    <a id="841" href="Effects.State.html#1295" class="Function">put</a> <a id="845" href="Expression.State.html#777" class="Bound">n</a>
    <a id="851" href="Denote.Tree.html#1261" class="Function">return</a> <a id="858" class="Symbol">(</a><a id="859" href="Value.Core.html#159" class="Field">inject</a> <a id="866" href="Expression.State.html#777" class="Bound">n</a><a id="867" class="Symbol">)</a>

<a id="870" class="Keyword">module</a> <a id="877" href="Expression.State.html#877" class="Module">_</a> <a id="879" class="Keyword">where</a> 

  <a id="889" href="Expression.State.html#889" class="Function">getᴱ</a> <a id="894" class="Symbol">:</a> <a id="896" class="Symbol">⦃</a> <a id="898" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="908" href="Denote.Sig.html#1443" class="Function Operator">⊰</a> <a id="910" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="912" class="Symbol">⦄</a> <a id="914" class="Symbol">→</a> <a id="916" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="918" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="922" href="Expression.State.html#889" class="Function">getᴱ</a> <a id="927" class="Symbol">=</a> <a id="929" href="Denote.Sig.html#1657" class="Function">injectᶜ</a> <a id="937" class="Symbol">(</a><a id="938" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="944" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="946" class="Symbol">λ())</a>

  <a id="954" href="Expression.State.html#954" class="Function">putᴱ</a> <a id="959" class="Symbol">:</a> <a id="961" class="Symbol">⦃</a> <a id="963" href="Expression.State.html#342" class="Function">StateExpr</a> <a id="973" href="Denote.Sig.html#1443" class="Function Operator">⊰</a> <a id="975" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="977" class="Symbol">⦄</a> <a id="979" class="Symbol">→</a> <a id="981" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="983" href="Denote.Sig.html#621" class="Generalizable">σ</a> <a id="985" class="Symbol">→</a> <a id="987" href="Denote.Sig.html#482" class="Datatype">μ</a> <a id="989" href="Denote.Sig.html#621" class="Generalizable">σ</a>
  <a id="993" href="Expression.State.html#954" class="Function">putᴱ</a> <a id="998" href="Expression.State.html#998" class="Bound">e</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Denote.Sig.html#1657" class="Function">injectᶜ</a> <a id="1010" class="Symbol">(</a><a id="1011" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1016" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1018" class="Symbol">(λ</a> <a id="1021" href="Expression.State.html#1021" class="Bound">_</a> <a id="1023" class="Symbol">→</a> <a id="1025" href="Expression.State.html#998" class="Bound">e</a><a id="1026" class="Symbol">))</a>
</pre></body></html>